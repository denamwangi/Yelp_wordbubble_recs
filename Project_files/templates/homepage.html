{% extends 'base.html' %}
{% block content %}
<div class="container" style="margin-top: 8%;">
<div class="col-md-6 col-md-offset-3">     
<div class="row">
    <div class="page-header" class="text-center">
        <h1>Welcome to Bubble Reccs!</h1>
        <p class="lead">What would you like to search for?</p>
    </div>
<!-- Add a form that asks for the location in a dropdown and a category in a search box -->

<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="static/js/d3_bubbles.js"></script>
<script>
var width = 650,
    height = 650,
    padding = 8, // separation between same-color nodes
    clusterPadding = 6, // separation between different-color nodes
    maxRadius = 10;
</script>
<div class="form-group">
    <form action="/results" method="GET"  id="search-form" >
        Location:
            <select name="city" id="city" class="form-control" class="col-xs-6">>
                {% for city in cities %}
                    
                   <option value= "{{ city }}"> {{ city }} </option>
                    
                {% endfor %}
            </select>

        Category: 
            <input name="category" id="search-category" type="text" >
        <input type="submit">

    </form>
</div>



<div class='cat_bubbles_container'>
<div id='cat_bubbles'></div>
</div>
<script>

function make_category_bubbles(results){
    // Drop and re-add a container that will hold all the bubbles
    console.log("HEEERE"+results)
    $('#cat_bubbles').remove()
    $('.cat_bubbles_container').append('<div id="cat_bubbles"></div>')

    multiD3(results, 'cat_bubbles');
}

function get_weighted_categories(){
    var search_city_send= {

    search_city : $('#city').val()

    };
    console.log(search_city_send);
    $.get('/category_count.json', search_city_send, make_category_bubbles)
}

$("#city").on('change' , get_weighted_categories)




</script>
</div>
</div>
</div>
{% endblock %}
