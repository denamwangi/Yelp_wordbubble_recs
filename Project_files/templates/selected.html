{% extends 'base.html' %}

{% block content %}
    
    <style>


    body {
  background: url(../static/img/green_salad.jpg) no-repeat center center;
  background-size: cover;

}
            html, body {
              width: 100%;
              height: 100%;
              
            }
          /*body { background: black; }*/
    </style>


<div class="container_fluid" style="margin-top: 1%;">

    <div class="progress">
      <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="70"
      aria-valuemin="0" aria-valuemax="100" style="width:100%">
        <span class="sr-only">33% Complete</span>
      </div>
    </div>

    <div class="row"
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 col-md-offset-1 col-lg-offset-1 left" id="results_box"> 
                <h1> You have excellent taste. </h1>

                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-4 left">
                            <div style="width:450px;height:550px;" id="map">
                            </div></br>
                    </div>


      <!-- <div id="map"></div></br> -->
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 col-md-offset-1 col-lg-offset-1 left" > 
      

      
<!-- <span style="font-size:100%;color:yellow;">&starf;</span> -->
                <h3 id= 'name_stars' class="text-center"> {{final_pick['name']  }}</h3>
                  <div class="row">
                  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-8 col-lg-offset-3 center" > 
                    <button class"final_buttons" class="btn btn-primary" type="submit" id="directions">Driving directions</button>
                    <button class"final_buttons" class="btn btn-primary" type="submit" id="lyft">Lyft estimates</button>
                    <button class"final_buttons" class="btn btn-primary" type="submit" id="twilio">Text me details</button></br>
                    <form id="addr_form" >
                        Start Point: <input id="dir_test" type="text"> 
                    </form>
                  </div>
                  </div>

                  
                  
                  <div id="directionsPanel" style="float:right;width: 100%;height 50%"></div>




      <!-- <input type="submit"> -->

      
</div>
</div>
 </div>
  </div>
<script>
    $("#directions").on('click', function(){$("#dir_test").submit()});


</script>

<script src="static/js/google_map.js"> </script>

</script>
<script>console.log('Success1')</script>

<script>console.log('Success2')</script>
<script>
// $.get("/selected", function(res){ console.log(res)})
var final_pick_display = {{final_pick | tojson}};



// for (var i=0; i< final_pick_display['stars']; i++;) {
//     console.log(i)
// }

</script>


    <script>
function initMap4() {
    var map;
     var latitude = final_pick_display['latitude'];
    var longitude = final_pick_display['longitude'];
    var location = {lat: latitude, lng: longitude};

   
      function initMap3() {
        var directionsDisplay;
        var directionsService = new google.maps.DirectionsService;
        var directionsDisplay = new google.maps.DirectionsRenderer;
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 7,
          center: location
        });

 
      // Creates the actual google maps object that will be added to the map
      var marker = new google.maps.Marker({
              position: location,
              map: map,
            });
      

      

        directionsDisplay.setMap(map);
        directionsDisplay.setPanel(document.getElementById('directionsPanel'));

        var onChangeHandler = function() {
          calculateAndDisplayRoute(directionsService, directionsDisplay);
        };

        $("#addr_form").on("submit", onChangeHandler)


      }


      function calculateAndDisplayRoute(directionsService, directionsDisplay) {
        directionsService.route({
          origin: $("#dir_test").val(),
          destination: '"'+final_pick_display['latitude']+','+final_pick_display['longitude']+'"',
          travelMode: 'DRIVING'
        }, function(response, status) {
          if (status === 'OK') {
            directionsDisplay.setDirections(response);
          } else {
            window.alert('Directions request failed due to ' + status);
          }
        });
      }
    initMap3()
    // formatMarker(location);
    // debugger;
    console.log(location)
}
    </script>

    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDM8o4QXXEl_KvhpVuTL9S5OV-47bqQa80&callback=initMap4">

    </script>

{% endblock %}