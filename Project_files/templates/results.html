{% extends 'base.html' %}

{% block content %}
<style>
    text {
        text-anchor: middle;
        fill: white;
        font-family: sans-serif;
        font-weight: bold;
    }

    rect {
        fill: none;
        stroke: black;
    }
</style>


<h2> Hi from the results page!! </h2>
<p id="headline">  <p/>

<div> Add map here!</div></br>

<form action="/selected" id="results">

    <button type="submit" id="chosen_pics" >Show Me!</button >

</form>







<!-- <p> D3 experiment </p> -->
<svg height="150" width="470">
    <g transform="translate(0, 0)"></g>
    <g transform="translate(160, 0)"></g>
    <g transform="translate(320, 0)"></g>
</svg>


<!-- Get the data using ajax -->
<script>

    function showResults(results){
                    console.log("yay");
                    console.log(results);
                    businesses = results;
                    // addToDivs(businesses);
        // $('#headline').text("You searched for "+category+"in"+location)
    // var noOfResults = Object.keys(businesses).length;
                addDivs(businesses);
    };

  // WHY DOESNT THIS WORK?  
// var location = $('#state').val();
// var category = $('#search-category').val();
    var searchParams = {
        location : $('#state').val(),
        category : $('#search-category').val()
    };

    $.get('/restaurants_search.json', searchParams, showResults );

    function addDivs(businesses){
            for (var business in businesses) {


            $('#results').prepend('<div class="business details" id="'+business+
                                '">'+ businesses[business]['name']+'</div></br>')

            $('#'+business).append('<p>'+businesses[business]['nlp_summary']+'</p></br>')
            
            $('#results').prepend('<input class="finalpicks"  type="checkbox" value="'+businesses[business]['business_id'] +'" name=cbox_'+business +'>')
        }
    }


</script>
<!-- Give each restaurant a div of its own -->

{% endblock %}


<script>

    // groups = d3.selectAll("g");

    // groups.data([
    //     {"name": "Marketing", "headcount": 65},
    //     {"name": "Sales", "headcount": 50},
    //     {"name": "Quality", "headcount": 40}
    // ]);

    // groups.append("rect")
    //         .attr("width", 150)
    //         .attr("height", 150);
    // groups.append("circle")
    //         .attr("cx", 75)
    //         .attr("cy", 75)
    //         .attr("r", function (d) { return d.headcount; });
    // groups.append("text")
    //         .attr("x", 75)
    //         .attr("y", 75)
    //         .attr("dy", "0.35em")
          // .text(function(d) { return d.name } )
    </script>